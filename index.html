<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <title>SAVE THE WORLD</title>
    <meta name="description" content="HELLO THIS IS WEBPAGE">
		<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/92/three.js"></script>
    <script
			  src="https://code.jquery.com/jquery-3.3.1.js"
			  integrity="sha256-2Kok7MbOyxpgUVvAk/HJ2jigOSYS2auK4Pfzbm7uH60="
			  crossorigin="anonymous"></script>
    <script src='Stats.js'></script>
    <script src='main.js'></script>
    <script src='sprites.js'></script>
    <script src='audio.js'></script>
  </head>
  <body>

    <div id='main'></div>

    <script>
      function start(){
        let stats = new Stats()
        document.body.appendChild(stats.dom);
        $(stats.dom).css({
          left: '',
          right: 0,
        })

        // Launch an instance of the game with the tag above as its connection to the page
        let game = new Game($('#main'))
        var lastTimestamp = 0
        var running = true;

        function render(timestamp){
          stats.begin()
          try{
            window.requestAnimationFrame(render)
            let delta = (timestamp - lastTimestamp)/1000
            lastTimestamp = timestamp
            game.update(delta)
            game.draw(delta)
          } catch (error){
            console.error(error)
          }
          stats.end()
        }
        render(0)
      }


      {
        let domReady = false
        let spritesReady = false
        let audioReady = true

        function maybeStart(){
          if(domReady && spritesReady && audioReady) start()
        }

        // Ask three to load the graphics
        LoadAllSprites(() => {
          spritesReady = true;
          maybeStart()
        })

        // Wait for jquery to say the dom is loaded
        $(() => {
          domReady = true;
          maybeStart()
        })
      }

    </script>
  </body>
</html>
